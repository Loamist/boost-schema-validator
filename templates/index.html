<!DOCTYPE html>
<html lang="en" data-theme="boost" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>BOOST Schema Validator</title>

    <!-- Tailwind CSS (load FIRST) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- DaisyUI (load SECOND) -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.6.0/dist/full.min.css" rel="stylesheet" type="text/css" />

    <!-- Tailwind Configuration with Custom BOOST Theme (load AFTER Tailwind) -->
    <script>
        // Wait for Tailwind to be available
        if (typeof tailwind !== 'undefined') {
            tailwind.config = {
                darkMode: 'class',
                theme: {
                    extend: {
                        colors: {
                            'boost-green': '#4a7c59',
                            'boost-dark': '#2d5a27',
                            'boost-light': '#7fb069',
                        }
                    }
                },
                daisyui: {
                    themes: [
                        {
                            boost: {
                                "primary": "#4a7c59",          // Professional forest green
                                "primary-content": "#ffffff",
                                "secondary": "#5a9367",        // Medium sage green (lighter than primary)
                                "secondary-content": "#ffffff",
                                "accent": "#7fb069",           // Light green accent
                                "accent-content": "#ffffff",
                                "neutral": "#6c757d",          // Neutral gray
                                "neutral-content": "#ffffff",
                                "base-100": "#ffffff",         // Pure white
                                "base-200": "#f8f9fa",         // Soft gray background
                                "base-300": "#dee2e6",         // Light border gray
                                "base-content": "#2c3e50",     // Dark text
                                "info": "#5dade2",             // Soft blue (for info messages)
                                "info-content": "#ffffff",
                                "success": "#52c41a",          // Clean success green
                                "success-content": "#ffffff",
                                "warning": "#faad14",          // Warm orange (for warnings)
                                "warning-content": "#ffffff",
                                "error": "#dc2626",            // Professional red (for errors)
                                "error-content": "#ffffff",
                            }
                        }
                    ],
                    darkTheme: "boost",
                    base: true,
                    styled: true,
                    utils: true,
                }
            }
        }
    </script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <!-- Legacy CSS (Disabled - now using Tailwind + DaisyUI) -->
    <!-- <link rel="stylesheet" href="/static/css/styles.css"> -->

    <!-- Force green theme colors (override any cached DaisyUI) -->
    <style>
        [data-theme="boost"] {
            --p: 157 47% 38%;  /* #4a7c59 in HSL */
            --pf: 157 47% 30%;
            --pc: 0 0% 100%;
            --s: 141 29% 46%;  /* #5a9367 in HSL */
            --sf: 141 29% 38%;
            --sc: 0 0% 100%;
            --a: 123 33% 58%;  /* #7fb069 in HSL */
            --af: 123 33% 50%;
            --ac: 0 0% 100%;
        }
        .text-primary { color: #4a7c59 !important; }
        .border-primary { border-color: #4a7c59 !important; }
        .btn-primary {
            background-color: #4a7c59 !important;
            border-color: #4a7c59 !important;
        }
        .btn-outline.btn-primary {
            color: #4a7c59 !important;
            background-color: transparent !important;
        }
        .btn-outline.btn-primary:hover {
            background-color: #4a7c59 !important;
            color: white !important;
        }
        .select-primary {
            border-color: #4a7c59 !important;
        }
        .select-primary:focus {
            outline: 2px solid #4a7c59 !important;
        }
        .checkbox-primary:checked {
            background-color: #4a7c59 !important;
            border-color: #4a7c59 !important;
        }
        .card-title { color: #4a7c59 !important; }

        /* Modal fixes - ensure proper display and z-index */
        dialog.modal {
            position: fixed;
            z-index: 9999;
            background-color: transparent;
            border: none;
            padding: 0;
            max-width: 100vw;
            max-height: 100vh;
        }
        dialog.modal::backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
        dialog.modal[open] {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-box {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        /* Soften badge colors for better aesthetics */
        .badge {
            padding: 0.5rem 0.75rem !important; /* Override DaisyUI default padding */
        }
        .badge-error {
            background-color: #ef4444 !important;
            color: white !important;
        }
        .badge-success {
            background-color: #22c55e !important;
            color: white !important;
        }
        .badge-warning {
            background-color: #f59e0b !important;
            color: white !important;
        }

        /* Softer alert colors */
        .alert-error {
            background-color: #fee2e2 !important;
            border-color: #fca5a5 !important;
            color: #991b1b !important;
        }
        .alert-success {
            background-color: #dcfce7 !important;
            border-color: #86efac !important;
            color: #166534 !important;
        }

        /* Softer text colors */
        .text-error {
            color: #dc2626 !important;
        }
        .text-success {
            color: #16a34a !important;
        }

        /* Softer border colors */
        .border-error {
            border-color: #fca5a5 !important;
        }
        .border-success {
            border-color: #86efac !important;
        }

        /* Enhanced field table column widths - force with important */
        .enhanced-field-table {
            table-layout: fixed !important;
            width: 100% !important;
        }
        .enhanced-field-table th:nth-child(1),
        .enhanced-field-table td:nth-child(1) {
            width: 80px !important;
            max-width: 80px !important;
        }
        .enhanced-field-table th:nth-child(2),
        .enhanced-field-table td:nth-child(2) {
            width: 144px !important;
            max-width: 144px !important;
            font-size: 0.75rem !important;
        }
        .enhanced-field-table th:nth-child(3),
        .enhanced-field-table td:nth-child(3) {
            width: 96px !important;
            max-width: 96px !important;
        }
        .enhanced-field-table th:nth-child(4),
        .enhanced-field-table td:nth-child(4) {
            width: 256px !important;
            max-width: 256px !important;
            font-size: 0.75rem !important;
            word-break: break-all !important;
        }
        .enhanced-field-table th:nth-child(5),
        .enhanced-field-table td:nth-child(5) {
            width: 384px !important;
            max-width: 384px !important;
            font-size: 0.75rem !important;
        }
        .enhanced-field-table th:nth-child(6),
        .enhanced-field-table td:nth-child(6) {
            width: 160px !important;
            max-width: 160px !important;
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
            word-break: break-word !important;
            white-space: normal !important;
        }
        /* Force error messages to wrap */
        .enhanced-field-table td:nth-child(6) span,
        .enhanced-field-table td:nth-child(6) div {
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
            word-break: break-word !important;
            max-width: 160px !important;
            display: inline-block !important;
        }

        /* Fix button icon and text layout */
        .btn {
            display: inline-flex !important;
            flex-direction: row !important;
            align-items: center !important;
            justify-content: center !important;
            white-space: nowrap !important;
        }
        #validateBtn {
            min-width: fit-content !important;
        }
    </style>
</head>
<body class="bg-base-200 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <header class="mb-8 text-center py-8 px-6 rounded-xl shadow-lg" style="background: linear-gradient(135deg, #2d5a27 0%, #4a7c59 100%);">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-3">
                BOOST Schema Validator
            </h1>
            <p class="text-lg text-white/90">
                Test and validate BOOST entity schemas with real-time feedback
            </p>
        </header>

        <main class="space-y-6">
            <!-- Entity Selector Card -->
            <div class="card bg-base-100 shadow-xl border-l-4 border-primary">
                <div class="card-body">
                    <h2 class="card-title text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        Select Entity
                    </h2>

                    <div class="form-control w-full">
                        <label class="label" for="entitySelect">
                            <span class="label-text font-semibold">Choose a BOOST entity to validate:</span>
                        </label>
                        <select id="entitySelect" class="select select-bordered select-primary w-full">
                            <option value="">Loading entities...</option>
                        </select>
                    </div>

                    <div class="card-actions justify-end mt-4 gap-2">
                        <div class="dropdown dropdown-top" id="exampleDropdownContainer">
                            <label tabindex="0" class="btn btn-outline btn-primary" id="exampleDropdownBtn" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                </svg>
                                Load Example
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-72 max-h-96 overflow-y-auto absolute z-50 bottom-full mb-2" id="exampleDropdownMenu" style="left: 0;">
                                <!-- Dynamically populated -->
                            </ul>
                        </div>
                        <button id="loadSchemaBtn" class="btn btn-outline btn-primary" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                            View Schema
                        </button>
                    </div>
                </div>
            </div>

            <!-- Grid Layout for Editor and Results -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- JSON Editor Card -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-0">
                        <!-- Editor Header -->
                        <div class="bg-base-200 px-6 py-3 border-b border-base-300 flex justify-between items-center">
                            <h3 class="text-base font-semibold text-primary flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                                </svg>
                                Entity JSON Data
                            </h3>
                            <div class="flex items-center gap-2">
                                <button id="validateBtn" class="btn btn-primary btn-sm gap-1.5 px-4 h-10 min-h-10 flex-row" disabled>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>Validate</span>
                                </button>
                                <button id="clearBtn" class="btn btn-ghost btn-sm px-3 h-10 min-h-10">Clear</button>
                                <button id="formatBtn" class="btn btn-ghost btn-sm px-3 h-10 min-h-10">Format JSON</button>
                            </div>
                        </div>
                        <!-- Editor Textarea -->
                        <textarea
                            id="jsonEditor"
                            class="textarea w-full h-96 font-mono text-sm leading-relaxed rounded-none border-none focus:outline-none resize-none bg-base-100"
                            placeholder="Select an entity and load an example, or paste your JSON data here..."></textarea>
                    </div>
                </div>

                <!-- Validation Results Card -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-0">
                        <!-- Results Header -->
                        <div class="bg-base-200 px-6 py-3 border-b border-base-300 flex justify-between items-center gap-4">
                            <h3 class="text-base font-semibold text-primary flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                                </svg>
                                Validation Results
                            </h3>
                            <div id="validationStatus" class="badge badge-lg badge-ghost flex-shrink-0">
                                <span class="loading loading-dots loading-xs hidden" id="statusLoadingIcon"></span>
                                <span id="statusText">Ready</span>
                            </div>
                        </div>

                        <!-- Summary View -->
                        <div id="summaryView" class="p-6 min-h-96 flex items-center justify-center">
                            <div class="text-center text-base-content/50">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto mb-4 opacity-30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                </svg>
                                <p class="text-lg">üß™ Select an entity and click "Validate" to see results</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Entity Representation Section -->
            <section id="entityRepresentationSection" class="card bg-base-100 shadow-xl" style="display: none;">
                <div class="card-body">
                    <!-- Section Header with Tabs -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4">
                        <div>
                            <h2 class="text-2xl font-bold text-primary flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                                Entity Representation
                            </h2>
                            <p class="text-sm text-base-content/70 mt-1">
                                Human-readable format and visual journey mapping
                            </p>
                        </div>

                        <!-- View Toggle Tabs -->
                        <div class="tabs tabs-boxed bg-base-200">
                            <button id="plainTextBtn" class="tab tab-active" data-view="plainText">
                                üìÑ Plain Text
                            </button>
                            <button id="visualJourneyBtn" class="tab" data-view="visualJourney">
                                üó∫Ô∏è Visual Journey
                            </button>
                        </div>
                    </div>

                    <!-- Content Container -->
                    <div class="divider my-2"></div>

                    <!-- Plain Text View -->
                    <div id="plainTextRepresentation" class="representation-view">
                        <div id="plainTextContent" class="prose max-w-none">
                            <div class="alert">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-info shrink-0 w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>üìÑ Validation results will show human-readable format here</span>
                            </div>
                        </div>
                    </div>

                    <!-- Visual Journey View -->
                    <div id="visualJourneyRepresentation" class="representation-view hidden">
                        <div id="visualJourneyContent">
                            <div class="alert">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-info shrink-0 w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>üó∫Ô∏è Journey map and visual representation will appear here</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Field Analysis Section -->
            <section id="fieldAnalysisSection" class="card bg-base-100 shadow-xl" style="display: none;">
                <div class="card-body">
                    <!-- Section Header with Controls -->
                    <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-4">
                        <div>
                            <h2 class="text-2xl font-bold text-primary flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                                </svg>
                                Field Analysis
                            </h2>
                            <p class="text-sm text-base-content/70 mt-1">
                                Detailed field-by-field validation results with BOOST schema context
                            </p>
                        </div>

                        <!-- Controls -->
                        <div class="flex flex-wrap gap-2">
                            <label class="label cursor-pointer gap-2">
                                <input type="checkbox" id="showErrorsOnly" class="checkbox checkbox-sm checkbox-primary" />
                                <span class="label-text">Show errors only</span>
                            </label>
                            <button id="expandAllBtn" class="btn btn-sm btn-outline btn-neutral">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                                Expand All
                            </button>
                        </div>
                    </div>

                    <div class="divider my-2"></div>

                    <!-- Field Table Container -->
                    <div id="fieldTableContainer" class="overflow-x-auto">
                        <div class="flex items-center justify-center py-12">
                            <div class="text-center text-base-content/50">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto mb-4 opacity-30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                </svg>
                                <p>üìä Field analysis will appear after validation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gap Analysis Section (LCFS Demo Mode) -->
            <section id="gapAnalysisSection" class="card bg-base-100 shadow-xl" style="display: none;">
                <div class="card-body">
                    <div id="gapAnalysisContainer">
                        <!-- Gap analysis content will be dynamically generated here -->
                    </div>
                </div>
            </section>

        </main>

        <!-- Schema Modal (DaisyUI) -->
        <dialog id="schemaModal" class="modal">
            <div class="modal-box max-w-4xl">
                <form method="dialog">
                    <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">‚úï</button>
                </form>
                <h3 id="schemaModalTitle" class="font-bold text-lg text-primary mb-4">Entity Schema</h3>
                <div class="modal-body">
                    <pre id="schemaContent" class="bg-base-200 p-4 rounded-lg overflow-x-auto text-sm"></pre>
                </div>
            </div>
            <form method="dialog" class="modal-backdrop">
                <button>close</button>
            </form>
        </dialog>

        <!-- Footer -->
        <footer class="mt-12 pb-8">
            <div class="divider"></div>
            <div class="text-center space-y-3 text-sm">
                <p class="font-semibold text-primary">
                    <strong>BOOST (Biomass Open Origin Standard for Tracking)</strong> - Schema Validation Tool
                </p>
                <p class="text-base-content/70">
                    Built using schemas from the
                    <a href="https://github.com/carbondirect/BOOST" target="_blank" class="link link-primary">BOOST Standard</a>
                    by the
                    <a href="https://www.w3.org/community/boost-01/" target="_blank" class="link link-primary">W3C BOOST Community Group</a>
                    | Licensed under
                    <a href="https://www.w3.org/copyright/software-license/" target="_blank" class="link link-primary">W3C Software License</a>
                </p>
                <p class="text-base-content/50 italic text-xs">
                    Standalone validation tool - not the official BOOST repository
                </p>
            </div>
        </footer>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script type="module" src="/static/js/main.js"></script>
</body>
</html>